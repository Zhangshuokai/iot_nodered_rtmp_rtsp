---
description: 
globs: 
alwaysApply: false
---
# 准望物联监测平台安全设计

## 身份认证与授权

### 用户认证
- 使用JWT (JSON Web Token) 进行身份验证
- 密码使用bcrypt加密存储
- 支持多因素认证
- 会话超时自动登出

### 权限控制
- 基于角色的权限控制 (RBAC)
- 权限粒度控制到功能操作级别
- 组织隔离，不同组织数据默认相互隔离
- 资源访问控制，按组织和用户权限控制访问

## 用户角色定义

1. **系统管理员**
   - 权限范围：所有功能的完全访问权限
   - 特殊权限：平台定制、组织管理、用户管理

2. **组织管理员**
   - 权限范围：所属组织内的所有功能
   - 特殊权限：组织内用户管理、设备管理

3. **普通用户**
   - 权限范围：被授权的功能模块
   - 特殊权限：无

4. **设备用户**
   - 权限范围：特定设备的访问和控制
   - 特殊权限：无

## 数据安全

### 传输安全
- 使用HTTPS/TLS加密所有通信
- API请求使用签名验证
- WebSocket通信使用安全连接

### 存储安全
- 敏感数据加密存储
- 数据库访问权限最小化
- 定期数据备份

## 防攻击措施

### SQL注入防护
- 使用Prisma ORM进行参数化查询
- 避免直接拼接SQL语句

### XSS攻击防护
- React自动转义输入
- 实施内容安全策略(CSP)
- 输入验证和过滤

### CSRF攻击防护
- 使用CSRF令牌
- 验证请求来源

### DDoS防护
- API请求限流
- 异常流量监控
- 黑名单机制

### 其他安全措施
- 输入验证：前后端双重验证
- 错误处理：不泄露敏感信息
- 日志记录：记录安全相关事件

## 设备安全

### 设备认证
- 设备唯一标识符
- 设备密钥认证
- 证书认证（可选）

### 设备通信安全
- 通信加密
- 消息签名
- 消息有效性验证

### 设备权限管理
- 设备操作权限控制
- 命令下发审计
- 异常操作监控

## API安全

### API访问控制
- 基于JWT的身份验证
- 基于角色的权限控制
- API访问频率限制

### API日志
- 记录API访问情况
- 异常访问监控
- 审计追踪

